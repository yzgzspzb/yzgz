<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>æ¨åº„é«˜ä¸­ Â· æ ¡å›­è§†é¢‘ç›´æ’­ä¸­å¿ƒ</title>
    <!-- Video.js æ ¸å¿ƒæ ·å¼ (8.x å†…ç½® HLS) -->
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        /* å®Œå…¨ä¿ç•™åŸæœ‰æ ·å¼ï¼Œä¸åšåˆ å‡ï¼Œä»…å¾®è°ƒé€šé“è®¡æ•°åŠ¨æ€æ›´æ–° */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #1a2639;
            font-family: 'Microsoft YaHei', 'Segoe UI', 'PingFang SC', Roboto, Arial, sans-serif;
            padding: 16px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .main-container {
            width: 100%;
            max-width: 1500px;
            background: #0f1a2b;
            border-radius: 36px;
            box-shadow: 0 25px 45px rgba(0, 0, 0, 0.9);
            overflow: hidden;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 28px;
        }

        .top-datetime {
            color: #aac8ff;
            font-size: 1.1rem;
            padding: 0 0 8px 10px;
            text-align: left;
            font-family: 'Consolas', 'Monaco', monospace;
            letter-spacing: 0.5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.6);
        }

        .red-ticker {
            background: #b22222;
            border-radius: 60px;
            padding: 12px 25px;
            border: 2px solid #ff8a8a;
            box-shadow: inset 0 -3px 0 #6d1a1a, 0 10px 15px rgba(0,0,0,0.3);
        }

        .ticker-wrapper {
            height: 160px;
            overflow: hidden;
            position: relative;
            color: white;
            font-size: 1.2rem;
            font-weight: 500;
            line-height: 2.2;
            background: rgba(0,0,0,0.25);
            border-radius: 40px;
            padding: 0 20px;
            mask-image: linear-gradient(to bottom, transparent, black 10%, black 90%, transparent);
            -webkit-mask-image: linear-gradient(to bottom, transparent, black 10%, black 90%, transparent);
        }

        .ticker-list {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            transition: transform 0.6s ease-out;
            will-change: transform;
        }

        .ticker-list li {
            height: 56px;
            line-height: 56px;
            padding: 0 10px;
            border-bottom: 1px dashed #ffa0a0;
            color: #fff;
            text-shadow: 2px 2px 3px #4a0000;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 1.1rem;
        }

        .ticker-list li:last-child {
            border-bottom: none;
        }

        .player-row {
            display: grid;
            grid-template-columns: 1fr 310px;
            gap: 24px;
        }

        .player-area {
            min-width: 0;
            width: 100%;
            background: #0a1422;
            border-radius: 34px;
            overflow: hidden;
            border: 2px solid #2a4070;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        .video-js {
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
            background: #000;
            transform: translateZ(0);
            will-change: transform;
            min-height: 200px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-js .vjs-tech {
            position: absolute;
            top: 0;
            left: 0;
            width: 100% !important;
            height: 100% !important;
            object-fit: contain;
        }

        .video-js video {
            width: 100% !important;
            height: 100% !important;
            object-fit: contain !important;
        }

        .status-bar {
            background: #10233b;
            padding: 14px 22px;
            border-top: 2px solid #2e4a78;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 18px;
            color: white;
            font-size: 1.1rem;
        }

        .now-playing-label {
            background: #1f3b60;
            padding: 8px 28px;
            border-radius: 40px;
            border-left: 6px solid #3d8cff;
            font-weight: 600;
            max-width: 65%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .live-hint {
            background: #1f314b;
            padding: 6px 22px;
            border-radius: 40px;
            color: #bbd5ff;
            border: 1px solid #4c70a0;
            font-size: 1rem;
        }

        .channel-rail {
            background: #12233f;
            border-radius: 40px;
            padding: 24px 18px;
            border: 2px solid #3a5680;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            width: 100%;
            min-width: 0;
        }

        .rail-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 8px 20px 8px;
            border-bottom: 2px solid #2f4a72;
            margin-bottom: 20px;
        }

        .rail-header h3 {
            color: #ffffff;
            font-size: 1.8rem;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .channel-count {
            background: #1e3a60;
            color: #ffffff;
            padding: 6px 16px;
            border-radius: 40px;
            font-size: 1rem;
            border: 1px solid #5a82c0;
        }

        .channel-list {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 14px;
            flex: 1;
            max-height: 450px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #476aa0 #1a2b44;
        }

        .channel-list::-webkit-scrollbar {
            width: 6px;
        }
        .channel-list::-webkit-scrollbar-track {
            background: #1a2b44;
            border-radius: 30px;
        }
        .channel-list::-webkit-scrollbar-thumb {
            background: #476aa0;
            border-radius: 30px;
        }

        .channel-item {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            background: #1e314f;
            border: 2px solid #3d5a85;
            border-radius: 60px;
            cursor: pointer;
            transition: all 0.2s ease;
            gap: 14px;
            color: #ffffff;
            font-size: 1.2rem;
            font-weight: 500;
            outline: none;
            box-shadow: 0 6px 10px rgba(0,0,0,0.5);
        }

        .channel-item:hover {
            background: #2a4070;
            border-color: #7da0ea;
            transform: translateX(5px);
        }

        .channel-item:focus-visible {
            outline: 3px solid #ffbb33;
            outline-offset: 2px;
        }

        .channel-item.active {
            background: #2a5a9c;
            border-color: #aac4ff;
            box-shadow: 0 0 18px #3a7eff;
        }

        .channel-icon {
            width: 20px;
            height: 20px;
            background: #7aa5ff;
            border-radius: 50%;
            flex-shrink: 0;
        }
        .active .channel-icon {
            background: #ffdb8e;
        }

        .channel-name {
            flex: 1;
            color: #ffffff;
            font-size: 1.2rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .extra-section {
            display: flex;
            flex-direction: column;
            gap: 24px;
            margin-top: 8px;
        }

        .headline-bar {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            background: #1b2b44;
            border-radius: 60px;
            padding: 16px 28px;
            border: 1px solid #3f5f8f;
        }
        .headline-bar .title-group {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 20px;
        }
        .headline-bar h2, .headline-bar h3 {
            color: white;
            font-weight: 500;
            margin: 0;
        }
        .headline-bar h2 { font-size: 1.5rem; }
        .headline-bar h3 { font-size: 1.3rem; }
        .bili-link-wrapper {
            flex: 1;
            text-align: center;
            min-width: 200px;
        }
        .bili-link {
            display: inline-block;
            background: #1f3f6f;
            padding: 8px 30px;
            border-radius: 40px;
            color: white;
            text-decoration: none;
            font-size: 1.3rem;
            border: 1px solid #70a0ff;
            transition: 0.2s;
            white-space: nowrap;
        }
        .bili-link:hover {
            background: #2b56a0;
            transform: scale(1.02);
        }

        .bilibili-embed {
            background: #0f1e32;
            border-radius: 36px;
            padding: 22px;
            border: 2px solid #2f5190;
        }
        .bilibili-embed h3 {
            color: #ffd966;
            margin-bottom: 16px;
            font-size: 1.8rem;
            padding-left: 12px;
        }
        .bilibili-embed iframe {
            width: 100%;
            height: 380px;
            border-radius: 24px;
            border: none;
            background: #000;
        }

        .cctv-section {
            background: #112336;
            border-radius: 40px;
            padding: 24px 26px;
            border: 2px solid #3d5e8b;
        }
        .cctv-section h3 {
            color: #ffb347;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-left: 10px;
        }
        .cctv-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, auto));
            gap: 14px;
        }
        .cctv-grid dl {
            margin: 0;
        }
        .cctv-grid dt a {
            display: block;
            background: #1e3c62;
            color: white;
            text-decoration: none;
            padding: 14px 12px;
            border-radius: 50px;
            text-align: center;
            font-size: 1rem;
            font-weight: 500;
            border: 1px solid #5680c0;
            transition: 0.15s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.5);
        }
        .cctv-grid dt a:hover {
            background: #2f5090;
            border-color: #aac9ff;
            transform: translateY(-2px);
        }

        .footer-note {
            text-align: center;
            color: #9ab8e0;
            padding-right: 0;
        }
        .footer-note span {
            background: #1f3455;
            padding: 5px 30px;
            border-radius: 40px;
            color: white;
            font-size: 1rem;
            display: inline-block;
        }

        @media (max-width: 700px) {
            .player-row {
                grid-template-columns: 1fr;
            }
            .ticker-wrapper {
                height: 140px;
            }
            .ticker-list li {
                height: 48px;
                line-height: 48px;
                font-size: 1rem;
            }
            .now-playing-label {
                max-width: 100%;
            }
            .bilibili-embed iframe {
                height: 240px;
            }
            .cctv-grid {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            }
            .headline-bar {
                flex-direction: column;
                align-items: stretch;
            }
            .headline-bar .title-group {
                justify-content: center;
            }
            .bili-link-wrapper {
                margin-top: 8px;
            }
        }
    </style>
</head>
<body>
<div class="main-container">
    <!-- å·¦ä¸Šè§’åŠ¨æ€æ—¶é—´ -->
    <div class="top-datetime" id="currentDateTime"></div>

    <!-- çº¢è‰²æ»šåŠ¨å…¬å‘Šæ  -->
    <div class="red-ticker">
        <div class="ticker-wrapper" id="tickerWrapper">
            <ul class="ticker-list" id="tickerList">
                <li>æ¬¢è¿è®¿é—®æ¨åº„é«˜ä¸­è§†é¢‘ç›´æ’­ä¸­å¿ƒ</li>
                <li>å…¬å‘Š1ï¼š æœ¬ç½‘ç«™å†…æ‰€æœ‰è§†é¢‘èµ„æºï¼Œç‰ˆæƒå½’åŸå½±è§†åˆ¶ä½œå•ä½æ‰€æœ‰ã€‚ä»…ä¾›æˆ‘æ ¡æ ¡å›­å†…å¸ˆç”Ÿå…è´¹è§‚çœ‹ã€‚</li>
                <li>ç¦æ­¢ä»»ä½•äººä¸Šä¼ ç¬¬ä¸‰æ–¹å¹³å°ç”¨ä½œå•†ç”¨ï¼Œç”±æ­¤å¼•èµ·çš„ç‰ˆæƒçº çº·ç”±ä¾µæƒäººæ‰¿æ‹…ï¼Œæœªç»æœ¬ç½‘æˆ–æœ¬ç½‘æƒåˆ©äººæˆæƒï¼Œ</li>
                <li>ä»»ä½•äººä¸å¾—æ“…è‡ªä½¿ç”¨(åŒ…æ‹¬ä½†ä¸é™äºå¤åˆ¶ã€ä¼ æ’­ã€å±•ç¤ºã€é•œåƒã€ä¸Šè½½ã€ä¸‹è½½ã€è½¬è½½ã€æ‘˜ç¼–)æˆ–è®¸å¯ä»–äººä½¿ç”¨ä¸Šè¿°è§†é¢‘èµ„æºã€‚</li>
                <li>ç¦æ­¢ä»»ä½•åª’ä½“ã€ç½‘ç«™æˆ–ä¸ªäººåœ¨æœªç»ä¹¦é¢æˆæƒçš„æƒ…å†µä¸‹è½¬è½½ä½¿ç”¨ã€‚</li>
                <li>å…¬å‘Š2ï¼šå†…ç½‘ç›´æ’­é¢‘é“ä»…é™æˆ‘æ ¡æ•™å­¦æ¥¼åœ¨çº¿è§‚çœ‹ï¼Œå¤–ç½‘æ— æ³•è§‚çœ‹</li>
                <li>å…¬å‘Š3ï¼š æ ¡å›­å†…ç½‘å¼€æ”¾è®¿é—®ï¼Œæä¾›åœ¨çº¿è§‚çœ‹èŠ‚ç›®  ã€Š ä¿¡å·æµ‹è¯•  ã€‹</li>
            </ul>
        </div>
    </div>

    <!-- æ’­æ”¾å™¨ + å³ä¾§åˆ—è¡¨ (gridå¸ƒå±€å¼ºåˆ¶å¹¶æ’) -->
    <div class="player-row">
        <div class="player-area">
            <video id="myVideo" class="video-js vjs-big-play-centered" controls preload="auto"
                   playsinline webkit-playsinline x5-playsinline
                   crossorigin="anonymous"
                   width="1280" height="720"
                   poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1280' height='720' viewBox='0 0 1280 720'%3E%3Crect width='1280' height='720' fill='%23000'/%3E%3C/svg%3E">
                <source src="http://192.168.110.88:8088/livelan/stream.m3u8" type="application/x-mpegURL">
                <p class="vjs-no-js">æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ï¼Œè¯·å‡çº§æˆ–æ›´æ¢æµè§ˆå™¨ã€‚</p>
            </video>
            <div class="status-bar" id="statusBar">
                <div class="now-playing-label" id="nowPlaying">â¸ï¸ æœªæ’­æ”¾</div>
                <div class="live-hint" id="liveHint">ğŸ¬ ç‚¹å‡»é¢‘é“å¼€å§‹è§‚çœ‹</div>
            </div>
        </div>

        <div class="channel-rail">
            <div class="rail-header">
                <h3>ğŸ“º ç”µè§†åˆ—è¡¨</h3>
                <span class="channel-count">9ä¸ªå°</span>  <!-- ç¨ååŠ¨æ€æ›´æ–° -->
            </div>
            <ul class="channel-list" id="channelList"></ul>
            <div class="footer-note" style="margin-top: 16px;">
                <span>ğŸ“¡ æ ¡å›­å†…ç½‘ç›´è¿ </span>
            </div>
        </div>
    </div>

    <!-- é™„åŠ å†…å®¹ -->
    <div class="extra-section">
        <div class="headline-bar">
            <div class="title-group">
                <h2>ğŸ“¡ ä¸Šé¢æ’­æ”¾çª—å£æ˜¯æ ¡å›­å†…ç½‘ç›´æ’­ Â· ã€Šå‘¨æœ«å½±é™¢ã€‹ä»…é™æ ¡å›­æ•™å­¦æ¥¼è§‚çœ‹</h2>
                <h3>âœ¨ æ¨åº„é«˜ä¸­è§†é¢‘å±•æ’­ç›´æ’­ï¼ˆBç«™ï¼‰ âœ¨</h3>
            </div>
            <div class="bili-link-wrapper">
                <a href="https://space.bilibili.com/507501409" target="_blank" class="bili-link">ç‚¹å‡»è¿›å…¥Bç«™ç©ºé—´</a>
            </div>
        </div>

        <div class="bilibili-embed">
            <h3>ğŸ¥ æ¨åº„é«˜ä¸­æ ¡å›­è§†é¢‘å…¬ç½‘èŠ‚ç›®ï¼ˆBç«™ï¼‰</h3>
            <iframe src="https://www.bilibili.com/blackboard/live/live-activity-player.html?cid=25494416&quality=0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>

        <div class="cctv-section">
            <h3>ğŸ“º CCTVå¤®è§†å®˜æ–¹ç›´æ’­ï¼ˆç‚¹å‡»è·³è½¬ï¼‰</h3>
            <div class="cctv-grid" id="cctv-quick">
                <dl><dt><a href="https://tv.cctv.com/live/cctv1/" target="_blank">CCTV-1 ç»¼åˆ</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv2/" target="_blank">CCTV-2 è´¢ç»</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv3/" target="_blank">CCTV-3 ç»¼è‰º</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv4/" target="_blank">CCTV-4 ä¸­æ–‡</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv5/" target="_blank">CCTV-5 ä½“è‚²</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv6/" target="_blank">CCTV-6 ç”µå½±</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv7/" target="_blank">CCTV-7 å†›äº‹</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv8/" target="_blank">CCTV-8 ç”µè§†å‰§</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctvjilu/" target="_blank">CCTV-9 çºªå½•</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv10/" target="_blank">CCTV-10 ç§‘æ•™</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv11/" target="_blank">CCTV-11 æˆæ›²</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv12/" target="_blank">CCTV-12 ç¤¾ä¼šä¸æ³•</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv13/" target="_blank">CCTV-13 æ–°é—»</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctvchild/" target="_blank">CCTV-14 å°‘å„¿</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv15/" target="_blank">CCTV-15 éŸ³ä¹</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv16/" target="_blank">CCTV-16 å¥¥æ—åŒ¹å…‹</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctv17/" target="_blank">CCTV-17 å†œä¸šå†œæ‘</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctveurope/index.shtml" target="_blank">CCTV-4 ä¸­æ–‡å›½é™…ï¼ˆæ¬§ï¼‰</a></dt></dl>
                <dl><dt><a href="https://tv.cctv.com/live/cctvamerica/" target="_blank">CCTV-4 ä¸­æ–‡å›½é™…ï¼ˆç¾ï¼‰</a></dt></dl>
            </div>
        </div>

        <div class="footer-note">
            <span>æ¨åº„é«˜ä¸­æ ¡å›­ç½‘ç»œä¸­å¿ƒ Â· ä»…é™æ ¡å›­å†…éƒ¨ä½¿ç”¨</span>
        </div>
    </div>
</div>

<!-- å¼•å…¥ video.js åº“ -->
<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script>
(function() {
    // ----- å…«ä¸ªåŸæœ‰é¢‘é“ + ç¬¬ä¹ä¸ªå›ºå®šé¢‘é“ (éƒ‘å·æ•™è‚²å°ï¼Œhttp://livezzutv.chinamcache.com/zb02/zb02.m3u8ä¸å†æ”¯æŒè‡ªå®šä¹‰) -----
    const channels = [
        { name: 'æ¨åº„é«˜ä¸­æ ¡å›­è§†é¢‘', url: 'http://192.168.110.88:8088/livelan/stream.m3u8' },
        { name: 'éƒ‘å·æ•™è‚²å°', url: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8' },
        { name: 'å¹³èˆ†ç»¼åˆ', url: 'http://tvpull.dxhmt.cn:9081/tv/11723-1.m3u8' },
        { name: 'ç™»å°ç»¼åˆ', url: 'http://tvpull.dxhmt.cn:9081/tv/10185-1.m3u8' },
        { name: 'ç¡®å±±æ–°é—»ç»¼åˆ', url: 'http://tvpull.dxhmt.cn:9081/tv/11725-1.m3u8' },
        { name: 'æ³Œé˜³æ–°é—»ç»¼åˆ', url: 'http://tvpull.dxhmt.cn:9081/tv/11726-1.m3u8' },
        { name: 'é‚å¹³ä¸€å¥—', url: 'http://tvpull.dxhmt.cn:9081/tv/11728-1.m3u8' },
        { name: 'æ–°è”¡ç»¼åˆ', url: 'http://tvpull.dxhmt.cn:9081/tv/11729-1.m3u8' },
        { name: 'ä¸Šè”¡ç»¼åˆ', url: 'http://tvpull.dxhmt.cn:9081/tv/11722-1.m3u8' },   
    ];

    // ä¸å†è¯»å–localStorageï¼Œå®Œå…¨å›ºå®šç¬¬ä¹å°é“¾æ¥

    let activeIndex = 0;
    let retryCount = 0;
    const MAX_RETRY = 3;

    const player = videojs('myVideo', {
        controls: true,
        preload: 'auto',
        autoplay: false,
        techOrder: ['html5'],
        html5: {
            hls: {
                overrideNative: false,
                enableLowInitialPlaylist: true,
                smoothQualityChange: true
            }
        },
        liveui: false,
        playbackRates: [0.5, 1, 1.5, 2]
    });

    const channelListEl = document.getElementById('channelList');
    const nowPlayingEl = document.getElementById('nowPlaying');
    const liveHintEl = document.getElementById('liveHint');
    const channelCountSpan = document.querySelector('.channel-count');

    function updateStatusText(text, hint) {
        nowPlayingEl.innerText = text;
        if (hint !== undefined) liveHintEl.innerText = hint;
    }

    // æ’­æ”¾å™¨äº‹ä»¶ç›‘å¬
    player.on('waiting', () => {
        updateStatusText(nowPlayingEl.innerText, 'â³ ç¼“å†²ä¸­...');
    });
    player.on('playing', () => {
        retryCount = 0;
        const name = channels[activeIndex]?.name || 'æœªçŸ¥é¢‘é“';
        updateStatusText(`ğŸ“¡ æ­£åœ¨æ’­æ”¾ï¼š${name}`, 'ğŸ¬ æµç•…æ’­æ”¾');
    });
    player.on('error', () => {
        const name = channels[activeIndex]?.name || 'æœªçŸ¥é¢‘é“';
        updateStatusText(`âš ï¸ æ’­æ”¾é”™è¯¯: ${name}`, 'âŒ é“¾æ¥å¤±è´¥');
        if (retryCount < MAX_RETRY) {
            retryCount++;
            liveHintEl.innerText = `â³ ç¬¬ ${retryCount} æ¬¡é‡è¯•...`;
            setTimeout(() => {
                player.src({ type: 'application/x-mpegURL', src: channels[activeIndex].url });
                player.load();
                player.play().catch(() => {});
            }, 1500);
        } else {
            liveHintEl.innerText = 'âŒ å¤šæ¬¡é‡è¯•å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨åˆ‡æ¢é¢‘é“';
        }
    });
    player.on('pause', () => {
        liveHintEl.innerText = 'â¸ï¸ å·²æš‚åœ';
    });

    // æ¸²æŸ“é¢‘é“åˆ—è¡¨ (æ‰€æœ‰é¢‘é“ç»Ÿä¸€é£æ ¼ï¼Œç¬¬ä¹å°ä¸å†æœ‰åŒå‡»è®¾ç½®)
    function renderChannelList() {
        channelListEl.innerHTML = '';
        channels.forEach((ch, idx) => {
            const li = document.createElement('li');
            li.className = 'channel-item';
            if (idx === activeIndex) li.classList.add('active');
            li.setAttribute('data-index', idx);
            li.setAttribute('role', 'button');
            li.setAttribute('tabindex', '0');
            li.setAttribute('aria-label', `æ’­æ”¾ ${ch.name}`);

            const iconSpan = document.createElement('span');
            iconSpan.className = 'channel-icon';

            const nameSpan = document.createElement('span');
            nameSpan.className = 'channel-name';
            // æ‰€æœ‰é¢‘é“ç›´æ¥æ˜¾ç¤ºåç§°ï¼Œç¬¬ä¹å°å›ºå®šä¸º"éƒ‘å·æ•™è‚²å°"ï¼Œæ— ç‰¹æ®Šæ ‡è®°
            nameSpan.textContent = ch.name;

            li.appendChild(iconSpan);
            li.appendChild(nameSpan);

            // å•å‡»åˆ‡æ¢é¢‘é“ (æ‰€æœ‰é¢‘é“ä¸€è§†åŒä»ï¼Œæ— è‡ªå®šä¹‰åˆ¤æ–­)
            li.addEventListener('click', (e) => {
                e.preventDefault();
                const index = parseInt(li.getAttribute('data-index'), 10);
                switchChannel(index);
            });

            // é”®ç›˜æ”¯æŒ (Enter/Space)
            li.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    const index = parseInt(li.getAttribute('data-index'), 10);
                    switchChannel(index);
                }
            });

            channelListEl.appendChild(li);
        });

        // æ›´æ–°é¢‘é“è®¡æ•°
        if (channelCountSpan) {
            channelCountSpan.textContent = channels.length + 'ä¸ªå°';
        }
    }

    // åˆ‡æ¢é¢‘é“æ ¸å¿ƒé€»è¾‘ (æ‰€æœ‰é¢‘é“å‡æœ‰urlï¼Œä½†ä¿ç•™ç©ºå€¼é˜²å¾¡)
    function switchChannel(newIndex) {
        if (newIndex < 0 || newIndex >= channels.length) return;
        const targetChannel = channels[newIndex];

        // æ›´æ–°æ¿€æ´»ç´¢å¼•
        activeIndex = newIndex;
        retryCount = 0;

        // æ›´æ–°æ‰€æœ‰é¡¹çš„activeç±»
        const allItems = document.querySelectorAll('.channel-item');
        allItems.forEach((item, i) => {
            if (i === activeIndex) item.classList.add('active');
            else item.classList.remove('active');
        });

        // é˜²å¾¡ï¼šå¦‚æœæŸä¸ªé¢‘é“æ„å¤–æ²¡æœ‰URLï¼ˆç†è®ºä¸Šä¸ä¼šï¼‰ï¼Œç»™å‡ºæç¤º
        if (!targetChannel.url) {
            player.pause();
            player.src(''); // æ¸…ç©ºè§†é¢‘æº
            updateStatusText(`â¸ï¸ ${targetChannel.name} æœªé…ç½®é“¾æ¥`, 'âš™ï¸ è¯·è”ç³»ç®¡ç†å‘˜');
            return;
        }

        // æ­£å¸¸æ’­æ”¾
        updateStatusText(`ğŸ”„ åˆ‡æ¢è‡³ ${targetChannel.name} ...`, 'â³ åŠ è½½ä¸­');
        player.src({ type: 'application/x-mpegURL', src: targetChannel.url });
        player.load();
        player.play().catch(() => {
            liveHintEl.innerText = 'â–¶ï¸ è¯·ç‚¹å‡»æ’­æ”¾æŒ‰é’®';
        });

        player.one('play', () => {
            updateStatusText(`ğŸ“¡ æ­£åœ¨æ’­æ”¾ï¼š${targetChannel.name}`, 'ğŸ¬ æµç•…æ’­æ”¾');
        });
        player.one('error', () => {
            updateStatusText(`âš ï¸ æ’­æ”¾å¤±è´¥: ${targetChannel.name}`, 'âŒ é“¾æ¥å¤±è´¥');
        });
    }

    // åˆå§‹åŒ–æ¸²æŸ“
    renderChannelList();

    // é»˜è®¤æ¿€æ´»ç¬¬ä¸€ä¸ªé¢‘é“å¹¶æ’­æ”¾
    activeIndex = 0;
    document.querySelectorAll('.channel-item')[0]?.classList.add('active');
    updateStatusText(`ğŸ“¡ æ­£åœ¨æ’­æ”¾ï¼š${channels[0].name}`, 'ğŸ¬ åˆå§‹åŠ è½½');
    switchChannel(0);  // é€šè¿‡switchChannelç»Ÿä¸€æ’­æ”¾ç¬¬ä¸€é¡¹

    // è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢æç¤º
    setTimeout(() => {
        if (player.paused() && !player.hasStarted_) {
            liveHintEl.innerText = 'â–¶ï¸ è¯·ç‚¹å‡»å³ä¾§é¢‘é“æˆ–æ’­æ”¾æŒ‰é’®';
        }
    }, 1200);

    // ---------- æ— ç¼æ»šåŠ¨å…¬å‘Šä¼˜åŒ– (ä¿æŒä¸å˜) ----------
    (function initTicker() {
        const tickerList = document.getElementById('tickerList');
        const tickerWrapper = document.getElementById('tickerWrapper');
        if (!tickerList || !tickerWrapper) return;

        const originalItems = Array.from(tickerList.children).map(li => li.innerHTML);
        tickerList.innerHTML = '';
        const doubleItems = [...originalItems, ...originalItems];
        doubleItems.forEach(html => {
            const li = document.createElement('li');
            li.innerHTML = html;
            tickerList.appendChild(li);
        });

        let itemHeight = 56;
        const firstLi = tickerList.children[0];
        if (firstLi) {
            itemHeight = firstLi.offsetHeight;
        }

        const originalCount = originalItems.length;
        const totalMove = itemHeight * originalCount;

        let scrollInterval;

        function moveStep() {
            const transform = tickerList.style.transform;
            let currentY = 0;
            if (transform && transform.includes('translateY')) {
                const match = transform.match(/translateY\(([-\d.]+)px\)/);
                if (match) currentY = parseFloat(match[1]);
            }

            let newY = currentY - itemHeight;

            if (Math.abs(newY) >= totalMove - 0.1) {
                tickerList.style.transition = 'none';
                tickerList.style.transform = 'translateY(0)';
                tickerList.offsetHeight;
                tickerList.style.transition = 'transform 0.6s ease-out';
                newY = -itemHeight;
            }

            tickerList.style.transform = `translateY(${newY}px)`;
        }

        scrollInterval = setInterval(moveStep, 3000);

        window.addEventListener('beforeunload', () => {
            if (scrollInterval) clearInterval(scrollInterval);
        });

        window.addEventListener('resize', () => {
            if (tickerList.children[0]) {
                const newHeight = tickerList.children[0].offsetHeight;
                if (newHeight !== itemHeight) {
                    itemHeight = newHeight;
                    tickerList.style.transition = 'none';
                    tickerList.style.transform = 'translateY(0)';
                    tickerList.offsetHeight;
                    tickerList.style.transition = 'transform 0.6s ease-out';
                }
            }
        });
    })();

    // å·¦ä¸Šè§’åŠ¨æ€æ—¶é—´
    function updateDateTime() {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hour = String(now.getHours()).padStart(2, '0');
        const minute = String(now.getMinutes()).padStart(2, '0');
        const dateTimeStr = `${year}å¹´${month}æœˆ${day}æ—¥ ${hour}æ—¶${minute}åˆ†`;
        const el = document.getElementById('currentDateTime');
        if (el) el.textContent = dateTimeStr;
    }
    updateDateTime();
    setInterval(updateDateTime, 1000);
})();
</script>
</body>
</html>
